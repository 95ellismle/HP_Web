{% extends 'ui/base.html' %}
{% load static %}

{% block content %}
	<script type="text/javascript" src="{% static 'js/sidebar.js' %}"></script>
	<!-- Sidebar -->
	<div class="w3-sidebar w3-black w3-bar-block">
		<form method="POST" class="post-form">{% csrf_token %}
			<input type="submit" class="w3-btn w3-ripple w3-green w3-right" style="margin-bottom: 0">

			<!-- Postcode -->
			<label class="w3-bar-item w3-left" style="margin-top: -15px"><b>Postcode</b></label>
			<input class="w3-bar-item w3-input mtext-field" type="text" name="postcode" id="id_postcode" maxlength="7">

			<!-- Street -->
			<label class="w3-bar-item"><b>Street</b></label>
			<input class="w3-bar-item w3-input mtext-field" type="text" name="street" id="id_street" maxlength="70">
			
			<!-- City -->
			<label class="w3-bar-item"><b>City</b></label>
			<input class="w3-bar-item w3-input mtext-field" type="text" name="city" id="id_city" maxlength="70">

			<!-- County -->
			<label class="w3-bar-item"><b>County</b></label>
			<input class="w3-bar-item w3-input mtext-field" type="text" name="county" id="id_county" maxlength="40">

			<!-- Price -->
			<label class="w3-bar-item"><b>Price Range</b></label>
            <div class="slider-track mtext-field"></div>
            <input class="mtext-field" type="range" min="0" max="100" value="0" id="slider-1" oninput="slideOne()">
            <input class="mtext-field" type="range" min="0" max="100" value="100" id="slider-2" oninput="slideTwo()">
			<input style="display: none" id="id_price_low" name="price_low" type="number">
			<input style="display: none" id="id_price_high" name="price_high" type="number">
			<div class="w3-bar-item">
				<span style="float: left; color: #ef5040;"><b id="slider-val-1">0</b></span> 
				<span style="float:right; color: #50bf40;"><b id="slider-val-2">>2.5m</b></span>
			</div>
			<br>

			<!-- Dates -->
			<label class="w3-bar-item"><b>From</b></label>
			<input class="mtext-field w3-input" type="date" name="date_from" id="id_date_from" value="2018-01-01">
			<label class="w3-bar-item"><b>To</b></label>
			<input class="mtext-field w3-input" type="date" name="date_to" id="id_date_to">
			<script type="text/javascript">
				// Set the to date
				let elm_from = document.getElementById('id_date_to');
				const currDT = new Date();
				elm_from.value = currDT.getFullYear() + "-" 
							+ String(currDT.getMonth()+1).padStart(2,'0') + "-" 
							+ String(currDT.getDate()).padStart(2, '0');

				// Set the from date
				const three_years = new Date('2021/01/01') - new Date('2018/01/01');
				let elm_to = document.getElementById('id_date_from');
				const three_years_ago = new Date(currDT - three_years);
				elm_to.value = three_years_ago.getFullYear() + "-" 
							+ String(three_years_ago.getMonth()+1).padStart(2,'0') + "-" 
							+ String(three_years_ago.getDate()).padStart(2, '0');
			</script>

			<!-- Dwelling Type -->
			<label class="w3-bar-item" style="margin-top: 6px"><b>Dwelling Type</b></label>
			<input class="w3-check" type="checkbox" name="dwelling_type_checks" checked style="margin-left: 15px;"
				   onchange="set_form_check_value('dwelling_type')" value='Detached'>
			<label>Detatched</label>
			<br>
			<input class="w3-check" type="checkbox" name="dwelling_type_checks" checked style="margin-left: 15px"
				   onchange="set_form_check_value('dwelling_type')" value='Semi-Detached'>
			<label>Semi-detached</label>
			<br>
			<input class="w3-check" type="checkbox" name="dwelling_type_checks" checked style="margin-left: 15px"
				   onchange="set_form_check_value('dwelling_type')" value='Flat/Maisonette'>
			<label>Flat/Maisonette</label>
			<br>
			<input class="w3-check" type="checkbox" name="dwelling_type_checks" checked style="margin-left: 15px"
				   onchange="set_form_check_value('dwelling_type')" value='Terraced'>
			<label>Terraced</label>
			<br>
			<input class="w3-check" type="checkbox" name="dwelling_type_checks" style="margin-left: 15px" 
				   onchange="set_form_check_value('dwelling_type')" value='Other'>
			<label>Other</label>
			<input style="display: none" type="text" id="id_dwelling_type" name="dwelling_type" value="Detached,Semi-Detached,Flat/Maisonette,Terraced">

			<!-- Is New Build? -->
			<label class="w3-bar-item"><b>New Build</b></label>
			<input class="w3-check" type="checkbox" name="is_new_checks" value="is_new" style="margin-left: 15px" checked
				   onchange="set_form_check_value('is_new')">
			<label>Yes</label>
			<input class="w3-check" type="checkbox" name="is_new_checks" value="not_new" checked
				   onchange="set_form_check_value('is_new')">
			<label>No</label>
			<input style="display: none" type="text" id="id_is_new" name="is_new" value="is_new,not_new">

			<!-- Freehold or Leasehold? -->
			<label class="w3-bar-item"><b>Tenure</b></label>
			<input class="w3-check" type="checkbox" name="tenure_checks" value="freehold" style="margin-left: 15px" checked
				   onchange="set_form_check_value('tenure')">
			<label>Freehold</label>
			<br>
			<input class="w3-check" type="checkbox" name="tenure_checks" value="leasehold" style="margin-left: 15px" checked
				   onchange="set_form_check_value('tenure')">
			<label>Leasehold</label>
			<input style="display: none" type="text" id="id_tenure" name="tenure" value="freehold,leashold">
		</form>
	</div>

	<script type="text/javascript">
		const form_data={{form_data|safe}};
		populate_fields(form_data);
	</script>

	<!-- Main Body -->
	<div class="w3-container">
		<div class="w3-content">
			{% block main_content %}
			{% endblock %}
		</div>
	</div>

{% endblock %}

